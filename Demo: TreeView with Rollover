"""
TreeView with Rollover Effects

Create a two column treeview widget in Python's tkinter library.  The two 
columns should be populated with the key, value pairs of a dictionary 
instantiated at the top of the file.  Style the treeview so that the rows 
backgrounds alternate between white and light grey.  When a user selects one 
of the rows, set that row's background to a light blue.  When a mouse hovers 
over a row, change that row's background a darker grey.
"""


# Treeview now displays key, value pairs from dictionary regex_code

import tkinter as tk
from tkinter import ttk

# Sample dictionary for regex_code
regex_code = {
    "Email": r"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}",
    "Phone": r"\+?\d[\d -]{8,}\d",
    "URL": r"http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+",
    "Date": r"\b\d{1,2}/\d{1,2}/\d{2,4}\b",
}

def on_double_click(event):
    # Get the clicked row's "Item" text and insert it into the text input
    item_id = event.widget.focus()
    item = event.widget.item(item_id)
    item_text = item["text"]  # Get the text from the first column ("Item")
    if item_text:
        regex_entry.delete(0, tk.END)  # Clear the current text
        regex_entry.insert(0, item_text)  # Insert the "Item" text

def create_input_frame(parent):
    # Create a frame to hold the label and text input
    input_frame = ttk.Frame(parent)
    input_frame.grid(row=0, column=0, sticky="ew", padx=5, pady=5)

    # Add a label and entry widget
    label = ttk.Label(input_frame, text="Regular Expression")
    label.grid(row=0, column=0, sticky="w", padx=(0, 5))
    
    global regex_entry
    regex_entry = ttk.Entry(input_frame, width=50)
    regex_entry.grid(row=0, column=1, sticky="ew")

    input_frame.columnconfigure(1, weight=1)  # Make the entry stretchable

def create_directory_frame(parent):
    # Create a frame to hold the Treeview
    directory_frame = ttk.Frame(parent)
    directory_frame.grid(row=1, column=0, sticky="nsew", padx=5, pady=(0, 5))

    directory = ttk.Treeview(directory_frame)
    directory.pack(fill="both", expand=True)

    # Configure columns
    directory["columns"] = ("Link",)
    directory.column("#0", width=150, anchor="w")  # The first column (Treeview's text)
    directory.column("Link", width=300, anchor="w")  # The second column
    directory.heading("#0", text="Item")
    directory.heading("Link", text="Link")

    # Bind double-click event
    directory.bind("<Double-Button-1>", on_double_click)

    # Populate the Treeview with dictionary key-value pairs
    for key, value in regex_code.items():
        directory.insert("", "end", text=key, values=[value])

def create_window():
    global window
    window = tk.Tk()
    window.title("Treeview with Text Input")
    window.geometry("600x400")
    window.resizable(True, True)

    # Configure grid
    window.columnconfigure(0, weight=1)
    window.rowconfigure(1, weight=1)

    # Create input frame and directory frame
    create_input_frame(window)
    create_directory_frame(window)

    # Run the application
    window.mainloop()

if __name__ == "__main__":
    create_window()

