"""
After repeated failures to find a method of reliably justifying text in Tknter's 
text widget, I'm now attempting to create a simple Notepad application in Python 
using the wxPython TextCtrl widget to support justified text alignment through the 
StyleTextCtrl class.  I found this suggestion on Reddit.

Having never used wxPython, this code is going to be a blend of Stackforum code and
ChatGPT suggestions.
"""


import wx
import wx.stc as stc

def on_align(event, stc_ctrl, alignment):
    selected_text = stc_ctrl.GetSelectedText()
    if selected_text:
        start, end = stc_ctrl.GetSelection()
        stc_ctrl.SetSelection(start, end)
        if alignment == 'left':
            stc_ctrl.StyleSetSpec(stc.STC_STYLE_DEFAULT, "alignment: left;")
        elif alignment == 'center':
            stc_ctrl.StyleSetSpec(stc.STC_STYLE_DEFAULT, "alignment: center;")
        elif alignment == 'right':
            stc_ctrl.StyleSetSpec(stc.STC_STYLE_DEFAULT, "alignment: right;")
        elif alignment == 'justify':
            stc_ctrl.SetMarginType(1, wx.TEXT_ATTR_JUSTIFIED)

def create_menu_bar(frame, stc_ctrl):
    menubar = wx.MenuBar()

    format_menu = wx.Menu()
    left_align = format_menu.Append(wx.ID_ANY, "Left Align")
    center_align = format_menu.Append(wx.ID_ANY, "Center Align")
    right_align = format_menu.Append(wx.ID_ANY, "Right Align")
    justify_align = format_menu.Append(wx.ID_ANY, "Justify")

    frame.Bind(wx.EVT_MENU, lambda event: on_align(event, stc_ctrl, 'left'), left_align)
    frame.Bind(wx.EVT_MENU, lambda event: on_align(event, stc_ctrl, 'center'), center_align)
    frame.Bind(wx.EVT_MENU, lambda event: on_align(event, stc_ctrl, 'right'), right_align)
    frame.Bind(wx.EVT_MENU, lambda event: on_align(event, stc_ctrl, 'justify'), justify_align)

    menubar.Append(format_menu, "Format")
    frame.SetMenuBar(menubar)

def main():
    app = wx.App(False)
    frame = wx.Frame(None, wx.ID_ANY, "Simple Text Editor", size=(800, 600))
    stc_ctrl = stc.StyledTextCtrl(frame, style=wx.TE_MULTILINE | wx.TE_WORDWRAP)
    
    create_menu_bar(frame, stc_ctrl)

    frame.Show()
    app.MainLoop()

if __name__ == "__main__":
    main()

